-- DeadRails Script Hub
-- A complete script hub with auto bonds and multiple features
-- Place in StarterPlayerScripts

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local GuiService = game:GetService("GuiService")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera
local mouse = player:GetMouse()

-- Configuration
local config = {
    -- General Settings
    Enabled = true,
    ToggleKey = Enum.KeyCode.RightControl, -- Press right ctrl to toggle script hub
    
    -- Auto Bonds Settings
    AutoBondsEnabled = false,
    AutoBondsKey = Enum.KeyCode.B,
    AutoCollectDelay = 0.5,    -- Delay between collection attempts (seconds)
    AutoTeleportToBonds = false, -- Teleport to bonds (more risky)
    BondDetectionRange = 150,   -- Distance to detect bonds
    
    -- ESP Settings
    ESPEnabled = true,
    ESPToggleKey = Enum.KeyCode.E,
    PlayerESP = true,
    BondESP = true,
    ItemESP = true,
    ESPBoxColor = Color3.fromRGB(255, 255, 255),
    ESPBondColor = Color3.fromRGB(255, 215, 0), -- Gold color for bonds
    ESPItemColor = Color3.fromRGB(0, 255, 255), -- Cyan for items
    ESPBoxTransparency = 0.5,
    ESPBoxThickness = 2,
    ESPDistance = 500,          -- Maximum distance for ESP
    
    -- Combat Settings
    AimbotEnabled = false,
    AimbotKey = Enum.KeyCode.X,
    SilentAimEnabled = false,
    SilentAimKey = Enum.KeyCode.C,
    AimbotFOV = 100,            -- Field of view for aimbot
    AimbotSmoothness = 0.5,     -- Lower = smoother
    TeamCheck = true,           -- Don't target teammates
    
    -- Speed Hack Settings
    SpeedHackEnabled = false,
    SpeedHackKey = Enum.KeyCode.F,
    SpeedMultiplier = 2,        -- How much faster to go
    
    -- Anti-Stun Settings
    AntiStunEnabled = false,
    AntiStunKey = Enum.KeyCode.V,
    
    -- Mobile Button Settings
    MobileButtonSize = UDim2.new(0, 50, 0, 50),
    MobileButtonColor = Color3.fromRGB(200, 200, 200),
    MobileButtonActiveColor = Color3.fromRGB(0, 200, 0),
    MobileButtonTransparency = 0.3
}

-- Variables
local isMobile = GuiService:IsTenFootInterface() or UserInputService.TouchEnabled
local scripts = {
    AutoBonds = {enabled = config.AutoBondsEnabled},
    ESP = {enabled = config.ESPEnabled},
    Aimbot = {enabled = config.AimbotEnabled},
    SilentAim = {enabled = config.SilentAimEnabled},
    SpeedHack = {enabled = config.SpeedHackEnabled},
    AntiStun = {enabled = config.AntiStunEnabled}
}
local espObjects = {}
local bondObjects = {}
local itemObjects = {}
local targetedPlayer = nil
local isAiming = false
local lastBondCollectTime = 0
local mobileUI = nil

-- Utility Functions
local function getRoot(char)
    return char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
end

local function getTeamColor(player)
    if player.Team then
        return player.Team.TeamColor.Color
    elseif player.TeamColor then
        return player.TeamColor.Color
    else
        return Color3.fromRGB(255, 0, 0) -- Default to red
    end
end

local function isTeammate(player1, player2)
    -- If team check is disabled, they're never teammates
    if not config.TeamCheck then 
        return false 
    end
    
    -- Check if they're on the same team
    if player1.Team and player2.Team then
        return player1.Team == player2.Team
    end
    
    return false
end

local function isAlive(plr)
    local char = plr.Character
    if not char then return false end
    
    local humanoid = char:FindFirstChildOfClass("Humanoid")
    if not humanoid then return false end
    
    return humanoid.Health > 0
end

local function findBondsInWorkspace()
    local bonds = {}
    
    -- Search methods for different types of bond representations in DeadRails
    -- Method 1: Look for items with "Bond" in the name
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") or obj:IsA("Model") then
            if obj.Name:lower():find("bond") or 
               obj.Name:lower():find("money") or 
               obj.Name:lower():find("cash") then
                table.insert(bonds, obj)
            end
        end
    end
    
    -- Method 2: Look for specific models that represent bonds in many games
    for _, obj in pairs(workspace:GetDescendants()) do
        if (obj:IsA("BasePart") or obj:IsA("Model")) and
           (obj.Name:lower():find("collect") or obj.Name:lower():find("pickup")) then
            table.insert(bonds, obj)
        end
    end
    
    -- Look for bright glowing parts (common for collectibles)
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and obj:FindFirstChildOfClass("PointLight") then
            table.insert(bonds, obj)
        end
    end
    
    return bonds
end

local function findItemsInWorkspace()
    local items = {}
    
    -- Look for items with common names
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") or obj:IsA("Model") then
            if obj.Name:lower():find("item") or 
               obj.Name:lower():find("gun") or 
               obj.Name:lower():find("weapon") or
               obj.Name:lower():find("ammo") or
               obj.Name:lower():find("med") or
               obj.Name:lower():find("health") then
                table.insert(items, obj)
            end
        end
    end
    
    return items
end

-- Create the script hub UI
local function createScriptHubUI()
    local hubGui = Instance.new("ScreenGui")
    hubGui.Name = "DeadRailsScriptHub"
    hubGui.ResetOnSpawn = false
    hubGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    -- Make sure GUI works in Core and PlayerGui
    if syn and syn.protect_gui then
        syn.protect_gui(hubGui)
        hubGui.Parent = game.CoreGui
    else
        hubGui.Parent = player:WaitForChild("PlayerGui")
    end
    
    -- Create the main frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 250, 0, 350)
    mainFrame.Position = UDim2.new(0.85, -125, 0.5, -175)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.BackgroundTransparency = 0.2
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true
    mainFrame.Visible = false -- Hidden by default
    mainFrame.Parent = hubGui
    
    -- Add corner radius
    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 10)
    mainCorner.Parent = mainFrame
    
    -- Create title
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "TitleLabel"
    titleLabel.Size = UDim2.new(1, 0, 0, 30)
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    titleLabel.BackgroundTransparency = 0.2
    titleLabel.Text = "DeadRails Script Hub"
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextSize = 18
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Parent = mainFrame
    
    -- Add corner radius to title
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 10)
    titleCorner.Parent = titleLabel
    
    -- Create a list layout for script toggles
    local listLayout = Instance.new("UIListLayout")
    listLayout.Padding = UDim.new(0, 8)
    listLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    listLayout.Parent = mainFrame
    
    -- Create toggles for each script
    local toggleButtons = {}
    local yOffset = 40
    
    local scriptNames = {
        "Auto Bonds",
        "ESP Features",
        "Aimbot",
        "Silent Aim",
        "Speed Hack",
        "Anti-Stun"
    }
    
    local scriptKeys = {
        "AutoBonds",
        "ESP",
        "Aimbot",
        "SilentAim",
        "SpeedHack",
        "AntiStun"
    }
    
    for i, scriptName in ipairs(scriptNames) do
        local scriptKey = scriptKeys[i]
        
        -- Create toggle frame
        local toggleFrame = Instance.new("Frame")
        toggleFrame.Name = scriptKey .. "Toggle"
        toggleFrame.Size = UDim2.new(0.9, 0, 0, 40)
        toggleFrame.Position = UDim2.new(0.05, 0, 0, yOffset)
        toggleFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        toggleFrame.BackgroundTransparency = 0.2
        toggleFrame.BorderSizePixel = 0
        toggleFrame.LayoutOrder = i
        toggleFrame.Parent = mainFrame
        
        -- Add corner radius
        local toggleCorner = Instance.new("UICorner")
        toggleCorner.CornerRadius = UDim.new(0, 8)
        toggleCorner.Parent = toggleFrame
        
        -- Add text label
        local toggleLabel = Instance.new("TextLabel")
        toggleLabel.Name = "Label"
        toggleLabel.Size = UDim2.new(0.7, 0, 1, 0)
        toggleLabel.Position = UDim2.new(0, 10, 0, 0)
        toggleLabel.BackgroundTransparency = 1
        toggleLabel.Text = scriptName
        toggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        toggleLabel.TextSize = 16
        toggleLabel.Font = Enum.Font.Gotham
        toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
        toggleLabel.Parent = toggleFrame
        
        -- Add toggle button
        local toggleButton = Instance.new("TextButton")
        toggleButton.Name = "Button"
        toggleButton.Size = UDim2.new(0, 50, 0, 24)
        toggleButton.Position = UDim2.new(1, -60, 0.5, -12)
        toggleButton.BackgroundColor3 = scripts[scriptKey].enabled and 
                                        Color3.fromRGB(0, 170, 0) or 
                                        Color3.fromRGB(170, 0, 0)
        toggleButton.Text = scripts[scriptKey].enabled and "ON" or "OFF"
        toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        toggleButton.TextSize = 14
        toggleButton.Font = Enum.Font.GothamBold
        toggleButton.BorderSizePixel = 0
        toggleButton.Parent = toggleFrame
        
        -- Add corner radius to button
        local buttonCorner = Instance.new("UICorner")
        buttonCorner.CornerRadius = UDim.new(0, 8)
        buttonCorner.Parent = toggleButton
        
        -- Add click handler
        toggleButton.MouseButton1Click:Connect(function()
            scripts[scriptKey].enabled = not scripts[scriptKey].enabled
            toggleButton.BackgroundColor3 = scripts[scriptKey].enabled and 
                                            Color3.fromRGB(0, 170, 0) or 
                                            Color3.fromRGB(170, 0, 0)
            toggleButton.Text = scripts[scriptKey].enabled and "ON" or "OFF"
            
            -- Additional logic based on script type
            if scriptKey == "ESP" then
                -- Update ESP visibility
                for _, espData in pairs(espObjects) do
                    if espData.Container then
                        espData.Container.Visible = scripts.ESP.enabled
                    end
                end
                for _, bondData in pairs(bondObjects) do
                    if bondData.Container then
                        bondData.Container.Visible = scripts.ESP.enabled
                    end
                end
                for _, itemData in pairs(itemObjects) do
                    if itemData.Container then
                        itemData.Container.Visible = scripts.ESP.enabled
                    end
                end
            end
            
            -- Update mobile button appearance if it exists
            if mobileUI and mobileUI.Buttons and mobileUI.Buttons[scriptKey] then
                local mobileButton = mobileUI.Buttons[scriptKey]
                mobileButton.Button.BackgroundColor3 = scripts[scriptKey].enabled and 
                                                    config.MobileButtonActiveColor or 
                                                    config.MobileButtonColor
                mobileButton.StatusDot.BackgroundColor3 = scripts[scriptKey].enabled and 
                                                      Color3.fromRGB(0, 255, 0) or 
                                                      Color3.fromRGB(255, 0, 0)
            end
            
            -- Provide feedback
            game.StarterGui:SetCore("SendNotification", {
                Title = scriptName,
                Text = scripts[scriptKey].enabled and "Enabled" or "Disabled",
                Duration = 1
            })
        end)
        
        toggleButtons[scriptKey] = toggleButton
        yOffset = yOffset + 50
    end
    
    -- Add FOV circle for aimbot
    local fovCircle = Drawing.new("Circle")
    fovCircle.Visible = false
    fovCircle.Radius = config.AimbotFOV
    fovCircle.Color = Color3.fromRGB(255, 255, 255)
    fovCircle.Thickness = 1
    fovCircle.Transparency = 0.5
    fovCircle.NumSides = 60
    fovCircle.Filled = false
    
    -- Create mobile toggle button if on mobile
    local toggleHubButton
    if isMobile then
        toggleHubButton = Instance.new("ImageButton")
        toggleHubButton.Name = "ToggleHubButton"
        toggleHubButton.Size = UDim2.new(0, 60, 0, 60)
        toggleHubButton.Position = UDim2.new(0.1, 0, 0.5, 0)
        toggleHubButton.AnchorPoint = Vector2.new(0.5, 0.5)
        toggleHubButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        toggleHubButton.BackgroundTransparency = 0.3
        toggleHubButton.Image = "rbxassetid://3926307971"
        toggleHubButton.ImageRectOffset = Vector2.new(404, 364)
        toggleHubButton.ImageRectSize = Vector2.new(36, 36)
        toggleHubButton.ImageTransparency = 0.1
        toggleHubButton.Parent = hubGui
        
        -- Add rounded corners
        local buttonCorner = Instance.new("UICorner")
        buttonCorner.CornerRadius = UDim.new(1, 0)
        buttonCorner.Parent = toggleHubButton
        
        -- Add stroke for visibility
        local buttonStroke = Instance.new("UIStroke")
        buttonStroke.Thickness = 2
        buttonStroke.Color = Color3.fromRGB(255, 255, 255)
        buttonStroke.Transparency = 0.3
        buttonStroke.Parent = toggleHubButton
        
        -- Add text label
        local buttonLabel = Instance.new("TextLabel")
        buttonLabel.Name = "Label"
        buttonLabel.Size = UDim2.new(1, 0, 0.3, 0)
        buttonLabel.Position = UDim2.new(0, 0, 0.85, 0)
        buttonLabel.BackgroundTransparency = 1
        buttonLabel.Text = "MENU"
        buttonLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        buttonLabel.TextStrokeTransparency = 0
        buttonLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
        buttonLabel.TextSize = 14
        buttonLabel.Font = Enum.Font.GothamBold
        buttonLabel.Parent = toggleHubButton
        
        -- Toggle hub visibility on click
        toggleHubButton.MouseButton1Click:Connect(function()
            mainFrame.Visible = not mainFrame.Visible
        end)
    end
    
    -- Create an ESP container
    local espContainer = Instance.new("Folder")
    espContainer.Name = "ESPContainer"
    espContainer.Parent = hubGui
    
    -- Create mobile action buttons if on mobile
    local mobileButtons = {}
    if isMobile then
        -- Create a container for the mobile action buttons
        local buttonContainer = Instance.new("Frame")
        buttonContainer.Name = "MobileButtonContainer"
        buttonContainer.Size = UDim2.new(0, 60, 0.8, 0)
        buttonContainer.Position = UDim2.new(0, 10, 0.1, 0)
        buttonContainer.BackgroundTransparency = 1
        buttonContainer.Parent = hubGui
        
        -- Create a list layout for the buttons
        local buttonLayout = Instance.new("UIListLayout")
        buttonLayout.Padding = UDim.new(0, 10)
        buttonLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
        buttonLayout.SortOrder = Enum.SortOrder.LayoutOrder
        buttonLayout.Parent = buttonContainer
        
        -- Button configs
        local buttonConfigs = {
            {name = "AutoBonds", icon = "rbxassetid://6034684956", tooltip = "Auto Bonds", key = "AutoBonds"},
            {name = "ESP", icon = "rbxassetid://6031763426", tooltip = "ESP", key = "ESP"},
            {name = "Aimbot", icon = "rbxassetid://6034509993", tooltip = "Aimbot", key = "Aimbot"},
            {name = "SilentAim", icon = "rbxassetid://6034227061", tooltip = "Silent Aim", key = "SilentAim"},
            {name = "SpeedHack", icon = "rbxassetid://6034479951", tooltip = "Speed Hack", key = "SpeedHack"},
            {name = "AntiStun", icon = "rbxassetid://6034287594", tooltip = "Anti-Stun", key = "AntiStun"}
        }
        
        -- Create mobile action buttons
        for i, btnConfig in ipairs(buttonConfigs) do
            -- Create button
            local actionButton = Instance.new("ImageButton")
            actionButton.Name = btnConfig.name .. "Button"
            actionButton.Size = UDim2.new(0, 50, 0, 50)
            actionButton.BackgroundColor3 = scripts[btnConfig.key].enabled and 
                                          config.MobileButtonActiveColor or 
                                          config.MobileButtonColor
            actionButton.BackgroundTransparency = config.MobileButtonTransparency
            actionButton.Image = btnConfig.icon
            actionButton.ImageTransparency = 0.1
            actionButton.LayoutOrder = i
            actionButton.Parent = buttonContainer
            
            -- Add rounded corners
            local buttonCorner = Instance.new("UICorner")
            buttonCorner.CornerRadius = UDim.new(1, 0)
            buttonCorner.Parent = actionButton
            
            -- Add stroke for visibility
            local buttonStroke = Instance.new("UIStroke")
            buttonStroke.Thickness = 2
            buttonStroke.Color = Color3.fromRGB(0, 0, 0)
            buttonStroke.Transparency = 0.3
            buttonStroke.Parent = actionButton
            
            -- Add tooltip label
            local tooltipLabel = Instance.new("TextLabel")
            tooltipLabel.Name = "TooltipLabel"
            tooltipLabel.Size = UDim2.new(1, 0, 0.3, 0)
            tooltipLabel.Position = UDim2.new(0, 0, 0.85, 0)
            tooltipLabel.BackgroundTransparency = 1
            tooltipLabel.Text = btnConfig.tooltip
            tooltipLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            tooltipLabel.TextStrokeTransparency = 0
            tooltipLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            tooltipLabel.TextSize = 10
            tooltipLabel.Font = Enum.Font.GothamBold
            tooltipLabel.Parent = actionButton
            
            -- Add status indicator
            local statusDot = Instance.new("Frame")
            statusDot.Name = "StatusDot"
            statusDot.Size = UDim2.new(0, 12, 0, 12)
            statusDot.Position = UDim2.new(0.8, 0, 0.2, 0)
            statusDot.BackgroundColor3 = scripts[btnConfig.key].enabled and 
                                       Color3.fromRGB(0, 255, 0) or 
                                       Color3.fromRGB(255, 0, 0)
            statusDot.BorderSizePixel = 0
            statusDot.Parent = actionButton
            
            -- Add rounded corners to status dot
            local dotCorner = Instance.new("UICorner")
            dotCorner.CornerRadius = UDim.new(1, 0)
            dotCorner.Parent = statusDot
            
            -- Toggle feature on click
            actionButton.MouseButton1Click:Connect(function()
                scripts[btnConfig.key].enabled = not scripts[btnConfig.key].enabled
                
                -- Update button appearance
                actionButton.BackgroundColor3 = scripts[btnConfi
